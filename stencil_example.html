<p align="left"><table>
<tr>
<td valign="top" align="left"><font color="#ff0000" size="3" face="Courier New"><strong>&gt; </strong></font></td>
<td valign="top"><font color="#ff0000" size="3" face="Courier New"><strong>read("FD.mpl"):MFD():</td>
</tr>
</table></strong></font>&nbsp;</p>
<p align="left"><table width='100%'>
<tr>
<td valign="top" align="left"><font color="#0000ff" size="3" face="Courier New"><u><a href="http://www.maplesoft.com/support/help/errors/view.aspx?path=Warning,%20grid_functions%20is%20not%20assigned"></u></font><font color="#0000ff" size="3" face="Courier New"><u>Warning, grid_functions is not assigned</u></font></a></td>
</tr>&nbsp;</p>
<p align="left"><tr>
<td valign="top" align="left"><font color="#0000ff" size="3" face="Courier New">FD table updated, see the content using SFDT() command</td>
</tr>
</table></font>&nbsp;</p>
<p align="left"><table>
<tr>
<td valign="top" align="left"><font color="#ff0000" size="3" face="Courier New"><strong>&gt; </strong></font></td>
<td valign="top"><font color="#ff0000" size="3" face="Courier New"><strong>expr:=diff(f(x,y),x,y);</td>
</tr>
</table></strong></font>&nbsp;</p>
<p align="left"><table width='100%'>
<tr>
<td valign="top" align="left"><font color="#0000ff" size="3" face="Times New Roman"><img src="fd_images/stencil_example_1.gif" width="129" height="29" alt="diff(diff(f(x, y), x), y)" align="left" border="0"></td>
</tr>
</table></font>&nbsp;</p>
<p align="left"><table>
<tr>
<td valign="top" align="left"><font color="#ff0000" size="3" face="Courier New"><strong>&gt; </strong></font></td>
<td valign="top"><font color="#ff0000" size="3" face="Courier New"><strong> 	Stencil(expr,[[-1,0,1],[-1,0,1]],[hx,hy]);</td>
</tr>
</table></strong></font>&nbsp;</p>
<p align="left"><table width='100%'>
<tr>
<td valign="top" align="left"><font color="#0000ff" size="3" face="Times New Roman"><img src="fd_images/stencil_example_2.gif" width="491" height="30" alt="`+`(`-`(`/`(`*`(`/`(1, 4), `*`(`+`(`-`(f(`+`(x, `-`(hx)), `+`(y, `-`(hy)))), f(`+`(x, `-`(hx)), `+`(y, hy)), f(`+`(x, hx), `+`(y, `-`(hy))), `-`(f(`+`(x, hx), `+`(y, hy)))))), `*`(hy, `*`(hx)))))" align="left" border="0"></td>
</tr>
</table></font>&nbsp;</p>
<p align="left"><table>
<tr>
<td valign="top" align="left"><font color="#ff0000" size="3" face="Courier New"><strong>&gt; </strong></font></td>
<td valign="top"><font color="#ff0000" size="3" face="Courier New"><strong>Stencil(expr,[[-1,0,1],[-1,0,1]],[hx,hy],discretized=true);</td>
</tr>
</table></strong></font>&nbsp;</p>
<p align="left"><font color="#000000" size="3" face="Times New Roman"></font>&nbsp;</p>
<p align="left"><table width='100%'>
<tr>
<td valign="top" align="left"><font color="#0000ff" size="3" face="Times New Roman"><img src="fd_images/stencil_example_3.gif" width="407" height="30" alt="`+`(`-`(`/`(`*`(`/`(1, 4), `*`(`+`(`-`(f(`+`(i, `-`(1)), `+`(j, `-`(1)))), f(`+`(i, `-`(1)), `+`(j, 1)), f(`+`(i, 1), `+`(j, `-`(1))), `-`(f(`+`(i, 1), `+`(j, 1)))))), `*`(hy, `*`(hx)))))" align="left" border="0"></td>
</tr>
</table></font>&nbsp;</p>
<p align="left"><font color="#000000" size="3" face="Times New Roman">More Complex Example: </font>&nbsp;</p>
<p align="left"><font color="#000000" size="3" face="Times New Roman"></font>&nbsp;</p>
<p align="left"><table>
<tr>
<td valign="top" align="left"><font color="#ff0000" size="3" face="Courier New"><strong>&gt; </strong></font></td>
<td valign="top"><font color="#ff0000" size="3" face="Courier New"><strong>expr:=diff(u(x,t,y,z),x,x,t,z):</td>
</tr>
</table></strong></font>&nbsp;</p>
<p align="left"><table>
<tr>
<td valign="top" align="left"><font color="#ff0000" size="3" face="Courier New"><strong>&gt; </strong></font></td>
<td valign="top"><font color="#ff0000" size="3" face="Courier New"><strong>A:=Stencil(expr,[[0,1,-1,3],[-1,0,1],[0,1,2]],[hx,ht,hz]);</td>
</tr>
</table></strong></font>&nbsp;</p>
<p align="left"><table width='100%'>
<tr>
<td valign="top" align="left"><font color="#0000ff" size="3" face="Times New Roman"><img src="fd_images/stencil_example_4.gif" width="576" height="32" alt="`+`(`/`(`*`(`/`(1, 4), `*`(`+`(`-`(`*`(6, `*`(u(x, `+`(t, `-`(ht)), y, z)))), `*`(8, `*`(u(x, `+`(t, `-`(ht)), y, `+`(z, hz)))), `-`(`*`(2, `*`(u(x, `+`(t, `-`(ht)), y, `+`(z, `*`(2, `*`(hz))))))), `*..." align="left" border="0"><br><img src="fd_images/stencil_example_5.gif" width="576" height="14" alt="`+`(`/`(`*`(`/`(1, 4), `*`(`+`(`-`(`*`(6, `*`(u(x, `+`(t, `-`(ht)), y, z)))), `*`(8, `*`(u(x, `+`(t, `-`(ht)), y, `+`(z, hz)))), `-`(`*`(2, `*`(u(x, `+`(t, `-`(ht)), y, `+`(z, `*`(2, `*`(hz))))))), `*..." align="left" border="0"><br><img src="fd_images/stencil_example_6.gif" width="576" height="14" alt="`+`(`/`(`*`(`/`(1, 4), `*`(`+`(`-`(`*`(6, `*`(u(x, `+`(t, `-`(ht)), y, z)))), `*`(8, `*`(u(x, `+`(t, `-`(ht)), y, `+`(z, hz)))), `-`(`*`(2, `*`(u(x, `+`(t, `-`(ht)), y, `+`(z, `*`(2, `*`(hz))))))), `*..." align="left" border="0"><br><img src="fd_images/stencil_example_7.gif" width="576" height="14" alt="`+`(`/`(`*`(`/`(1, 4), `*`(`+`(`-`(`*`(6, `*`(u(x, `+`(t, `-`(ht)), y, z)))), `*`(8, `*`(u(x, `+`(t, `-`(ht)), y, `+`(z, hz)))), `-`(`*`(2, `*`(u(x, `+`(t, `-`(ht)), y, `+`(z, `*`(2, `*`(hz))))))), `*..." align="left" border="0"><br><img src="fd_images/stencil_example_8.gif" width="576" height="14" alt="`+`(`/`(`*`(`/`(1, 4), `*`(`+`(`-`(`*`(6, `*`(u(x, `+`(t, `-`(ht)), y, z)))), `*`(8, `*`(u(x, `+`(t, `-`(ht)), y, `+`(z, hz)))), `-`(`*`(2, `*`(u(x, `+`(t, `-`(ht)), y, `+`(z, `*`(2, `*`(hz))))))), `*..." align="left" border="0"><br><img src="fd_images/stencil_example_9.gif" width="576" height="14" alt="`+`(`/`(`*`(`/`(1, 4), `*`(`+`(`-`(`*`(6, `*`(u(x, `+`(t, `-`(ht)), y, z)))), `*`(8, `*`(u(x, `+`(t, `-`(ht)), y, `+`(z, hz)))), `-`(`*`(2, `*`(u(x, `+`(t, `-`(ht)), y, `+`(z, `*`(2, `*`(hz))))))), `*..." align="left" border="0"></td>
</tr>
</table></font>&nbsp;</p>
<p align="left"><table>
<tr>
<td valign="top" align="left"><font color="#ff0000" size="3" face="Courier New"><strong>&gt; </strong></font></td>
<td valign="top"><font color="#ff0000" size="3" face="Courier New"><strong>B:=A:</td>
</tr>
</table></strong></font>&nbsp;</p>
<p align="left"><table>
<tr>
<td valign="top" align="left"><font color="#ff0000" size="3" face="Courier New"><strong>&gt; </strong></font></td>
<td valign="top"><font color="#ff0000" size="3" face="Courier New"><strong>stp_tb:=[hx,ht,hz]:</td>
</tr>
</table></strong></font>&nbsp;</p>
<p align="left"><table>
<tr>
<td valign="top" align="left"><font color="#ff0000" size="3" face="Courier New"><strong>&gt; </strong></font></td>
<td valign="top"><font color="#ff0000" size="3" face="Courier New"><strong>for ii from 1 to nops(stp_tb) do</td>
</tr>
</table></strong></font>&nbsp;</p>
<p align="left"><table>
<tr>
<td valign="top" align="left"><font color="#ff0000" size="3" face="Courier New"><strong>&gt; </strong></font></td>
<td valign="top"><font color="#ff0000" size="3" face="Courier New"><strong>B:=convert(series(B,stp_tb[ii],4),polynom):</td>
</tr>
</table></strong></font>&nbsp;</p>
<p align="left"><table>
<tr>
<td valign="top" align="left"><font color="#ff0000" size="3" face="Courier New"><strong>&gt; </strong></font></td>
<td valign="top"><font color="#ff0000" size="3" face="Courier New"><strong>end do:</td>
</tr>
</table></strong></font>&nbsp;</p>
<p align="left"><table>
<tr>
<td valign="top" align="left"><font color="#ff0000" size="3" face="Courier New"><strong>&gt; </strong></font></td>
<td valign="top"><font color="#ff0000" size="3" face="Courier New"><strong>B;</td>
</tr>
</table></strong></font>&nbsp;</p>
<p align="left"><table width='100%'>
<tr>
<td valign="top" align="left"><font color="#0000ff" size="3" face="Times New Roman"><img src="fd_images/stencil_example_10.gif" width="576" height="30" alt="`+`((D[1, 1, 2, 4](u))(x, t, y, z), `*`(`/`(1, 6), `*`((D[1, 1, 2, 2, 2, 4](u))(x, t, y, z), `*`(`^`(ht, 2)))), `*`(`+`(`-`(`*`(`/`(1, 3), `*`((D[1, 1, 2, 4, 4, 4](u))(x, t, y, z)))), `-`(`*`(`/`(1, 1..." align="left" border="0"><br><img src="fd_images/stencil_example_11.gif" width="576" height="30" alt="`+`((D[1, 1, 2, 4](u))(x, t, y, z), `*`(`/`(1, 6), `*`((D[1, 1, 2, 2, 2, 4](u))(x, t, y, z), `*`(`^`(ht, 2)))), `*`(`+`(`-`(`*`(`/`(1, 3), `*`((D[1, 1, 2, 4, 4, 4](u))(x, t, y, z)))), `-`(`*`(`/`(1, 1..." align="left" border="0"></td>
</tr>
</table></font>&nbsp;</p>
<p align="left"><table>
<tr>
<td valign="top" align="left"><font color="#ff0000" size="3" face="Courier New"><strong>&gt; </strong></font></td>
<td valign="top"><font color="#ff0000" size="3" face="Courier New"><strong>residual:=simplify(eval(B-expr,{ht=0,hx=0,hz=0}));</td>
</tr>
</table></strong></font>&nbsp;</p>
<p align="left"><table width='100%'>
<tr>
<td valign="top" align="left"><font color="#0000ff" size="3" face="Times New Roman"><img src="fd_images/stencil_example_12.gif" width="79" height="14" alt="0" align="left" border="0"></td>
</tr>
</table></font>&nbsp;</p>
<p align="left"><table>
<tr>
<td valign="top" align="left"><font color="#ff0000" size="3" face="Courier New"><strong>&gt; </strong></font></td>
<td valign="top"></td>
</tr>
</table>&nbsp;</p>
